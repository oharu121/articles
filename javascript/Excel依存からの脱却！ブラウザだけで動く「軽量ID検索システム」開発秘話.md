# Excel依存からの脱却！ブラウザだけで動く「軽量ID検索システム」開発秘話

# はじめに

多くの現場では、増え続けるデータをExcelで管理し、その限界に直面しています。検索は遅く、複数人での同時更新もままなりません。かといって、厳しいセキュリティ要件やコスト、利用者のITスキルといった壁が、本格的な新システムの導入を阻むケースは少なくありません。

本記事では、まさにそうした状況下で、**ブラウザだけで動作する軽量な検索ツール** を開発した際の、技術的な挑戦と創意工夫についてご紹介します。

**課題：Excel管理の限界とシステム導入の高い壁**

今回のプロジェクトの対象は、日々増え続ける「**固有ID**」の管理業務でした。従来は共有フォルダ上のExcelファイルで管理されていましたが、下記のような深刻な課題を抱えていました。

>* **パフォーマンスの悪化**: データ件数の増加に伴い、特定のIDを検索するだけで数分待たされることもありました。
>* **属人化とヒューマンエラー**: 手作業での更新は、入力ミスやファイルの破損リスクと常に隣り合わせでした。
>* **セキュリティ**: サーバーサイドの環境構築やデータベースの導入は、セキュリティポリシー上許可されませんでした。
>* **ITリテラシー**: 利用者は非エンジニアが中心であり、専門的なソフトウェアのインストールや複雑な操作は避けたい状況でした。

これらの課題と制約を乗り越えるため、私たちは **「特別な環境構築を必要とせず、ブラウザだけで動作するクライアントサイド・ソリューション」** という方針を立てました。そこで白羽の矢が立ったのが、HTMLとJavaScriptです。

https://preeminent-licorice-855b0e.netlify.app/

### 技術的な挑戦と工夫

開発は順風満帆ではありませんでした。特に「ローカル環境でのデータ読み込み」と「大量データによるパフォーマンス低下」という2つの大きな壁を、以下の工夫で乗り越えました。

#### 1\. CORSの壁を越える「JS形式」でのデータ読み込み

通常、JavaScriptで外部ファイル（例: JSON）を読み込む際には `fetch` APIが使われます。しかし、ローカルファイル（`file://`プロトコル）から別のファイルを読み込もうとすると、ブラウザの **CORS (Cross-Origin Resource Sharing)** というセキュリティ機能にブロックされてしまいます。サーバーがない環境では、この問題を回避する必要がありました。

>**解決策：データを「JavaScriptファイル」として読み込む**

私たちは、データをJSON形式ではなく、**JavaScriptのオブジェクトを定義する `.js` ファイル**として保存する手法を選択しました。

```javascript
// 例: data-chunk-1.js
// データをグローバルにアクセス可能な関数に渡してセットする
setPukData({
  "ID-112233": { "authCode": "ABCD-1111", "serial": "SN-...", "updated_at": "..." },
  "ID-112234": { "authCode": "EFGH-2222", "serial": "SN-...", "updated_at": "..." }
  // ... more data
});
```

そして、HTML側では `<script>` タグを動的に生成し、このJSファイルを読み込みます。

```javascript
// DataLoader.js 内の loadPukData 関数
function loadPukData(filename) {
  return new Promise((resolve, reject) => {
    const script = document.createElement("script");
    script.src = `.../database/js/${filename}`; // データファイルのパス
    script.async = true;

    script.onload = () => {
      // 読み込みが完了したら、生成したscriptタグは不要なので削除
      script.parentNode.removeChild(script);
      resolve(true);
    };
    script.onerror = () => reject(/* エラー処理 */);

    document.body.appendChild(script);
  });
}
```

`<script>` タグによるファイル読み込みはCORSポリシーの対象外です。この特性を利用することで、サーバーレス環境でも安全に外部データを読み込むという課題をクリアしました。

-----

#### 2\. 大規模データを快適に扱う「動的読み込み」

数万件に及ぶ可能性のある全データを一度に読み込むと、低スペックなPCではブラウザが応答しなくなってしまいます。そこで、軽快な動作を実現するために、**必要なデータだけをその都度読み込む**仕組みを実装しました。

**解決策：管理番号の範囲に応じたデータ分割と動的ロード**

1.  **データを分割**: IDの元データである**管理番号**を一定の範囲（例: `100000`〜`199999`）で区切り、複数のJSファイルに分割して保存します。
2.  **必要なファイルだけを選択**: ユーザーが検索窓に**管理番号**を入力すると、その番号が含まれるファイル名がどれかを判定します。
3.  **動的に読み込み**: 判定された特定のファイルだけを、前述の `loadPukData` 関数で読み込みます。

<!-- end list -->

```javascript
// DataLoader.js 内の loadDataChunk と getFileRange 関数
async function loadDataChunk(managementId) {
  // 入力された管理番号から、読み込むべきファイル名を特定
  const filename = getFileRange(managementId);
  if (filename === loadedFile) return; // 既に読み込み済みなら何もしない

  // 特定されたファイルだけをロード
  await loadPukData(filename);
}
```

このアーキテクチャにより、アプリケーションの起動は瞬時に完了し、メモリ使用量も最小限に抑えることができました。結果として、どんな環境でもストレスなく利用できるパフォーマンスを確保しました。

-----

#### 3\. すべてのユーザーに優しいUI/UXデザイン

ツールは作って終わりではありません。ITスキルに関わらず、誰もが直感的に使えることが重要です。そのために、UI/UXにも細やかな配慮を凝らしました。

  * **トースト通知**: 「コピーしました！」「管理番号を正しく入力してください」といった操作結果を、画面隅の小さなポップアップで即座にフィードバック。これにより、ユーザーは自分の操作が正しく完了したか、あるいは何が間違っていたのかを瞬時に理解できます。

  * **視覚的なフィードバック**:

      * 検索ボタンを押すと、完了まで**スピナー**が表示され、処理中であることが一目で分かります。
      * 指定外の文字を入力すると、入力欄がブルブルと**震えるアニメーション**でエラーを知らせます。

  * **テーマ切り替え**: 長時間利用しても目が疲れにくいように、ワンクリックで切り替えられる**ライトモードとダークモード**を搭載しました。

これらの細やかな装飾は、単なる見た目の問題ではありません。ユーザーに安心感を与え、マニュアルを読まなくても操作に没入できるようにするための、重要な機能なのです。

### 結論：制約は創造性の源泉

今回の開発は、技術的な制約が、必ずしもネガティブなものではないことを教えてくれました。サーバーが使えない、データベースが導入できないといった厳しい条件下だったからこそ、**既存の技術（HTML/JavaScript）の可能性を深く掘り下げ、現場のニーズに真に寄り添ったシンプルな解決策**にたどり着くことができました。

高価なシステムを導入するだけがDX（デジタルトランスフォーメーション）ではありません。現場の課題に真摯に向き合い、手元の技術で創意工夫を凝らすこと。それこそが、持続可能で価値あるソリューションを生み出す鍵となるのです。この成功体験が、同様の課題を抱える方々にとって、何らかのヒントになれば幸いです。