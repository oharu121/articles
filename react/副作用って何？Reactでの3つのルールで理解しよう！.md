# ã¯ã˜ã‚ã«

Reactã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€`useEffect` ã‚„ `localStorage`ã€APIå‘¼ã³å‡ºã—ãªã©ã€ã„ã‚ã‚†ã‚‹ **å‰¯ä½œç”¨ï¼ˆside effectï¼‰** ã«ã¶ã¤ã‹ã‚‹ã“ã¨ãŒå¤šããªã‚Šã¾ã™ã€‚

ã§ã‚‚ã€å‰¯ä½œç”¨ã‚’ã¡ã‚ƒã‚“ã¨æ•´ç†ã§ãã¦ã„ãªã„ã¨â€¦

* ç„¡é§„ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãŒå¢—ãˆã‚‹
* åˆæœŸè¡¨ç¤ºãŒãƒã‚°ã‚‹
* ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆSSRï¼‰ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

ãªã©ã®ãƒˆãƒ©ãƒ–ãƒ«ã«ã¤ãªãŒã‚Šã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€Reactã§å‰¯ä½œç”¨ã‚’æ‰±ã†ã¨ãã«å¤§äº‹ãª**3ã¤ã®ãƒ«ãƒ¼ãƒ«**ã‚’ã€**ç°¡å˜ãªä¾‹ã¨ã¨ã‚‚ã«**ç´¹ä»‹ã—ã¾ã™ã€‚

# 1ï¸âƒ£æç”»ä¸­ã«å‰¯ä½œç”¨ã‚’å®Ÿè¡Œã—ãªã„

**âŒ ãƒ€ãƒ¡ãªä¾‹**
> localStorageã‹ã‚‰ç›´æ¥èª­ã¿è¾¼ã‚€
```tsx
const [name, setName] = useState(localStorage.getItem("name") || "")
```

**ğŸ§¨ ãªã«ãŒå•é¡Œï¼Ÿ**

* `localStorage.getItem()` ã¯å‰¯ä½œç”¨ï¼ˆå¤–éƒ¨ã®çŠ¶æ…‹ã‚’èª­ã‚€ï¼‰
* ãã‚Œã‚’ **`useState` ã®åˆæœŸå€¤ã¨ã—ã¦ç›´æ¥ä½¿ã†**ã¨ã€ReactãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’**æç”»ã™ã‚‹ãŸã³ã«å‰¯ä½œç”¨ãŒå®Ÿè¡Œã•ã‚Œã‚‹**
* SSRç’°å¢ƒã§ã¯ `localStorage` ãŒãªã„ãŸã‚ã€**ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹**

**âœ… è§£æ±ºç­–**
> useEffectã‚’ä½¿ã†

```tsx
const [name, setName] = useState("")

useEffect(() => {
  const stored = localStorage.getItem("name")
  if (stored) {
    setName(stored)
  }
}, [])
```

å‰¯ä½œç”¨ã¯ **useEffect ã®ä¸­ã§ã€æç”»ã®ã‚ã¨ã«å®Ÿè¡Œ**ã™ã‚‹ã“ã¨ã§å›é¿ã§ãã¾ã™ã€‚

# 2ï¸âƒ£å‰¯ä½œç”¨ã¯ç™ºç”Ÿæºï¼ˆã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã®ä¸­ã«ç½®ã

**âŒ ãƒ€ãƒ¡ãªä¾‹**
> å€¤ã®ä¿å­˜ã‚’useEffectã§ã‚„ã£ã¦ã—ã¾ã†

```tsx
useEffect(() => {
  localStorage.setItem("count", count)
}, [count])
```

**ğŸ§¨ ãªã«ãŒå•é¡Œï¼Ÿ**

* çŠ¶æ…‹ãŒå¤‰ã‚ã‚‹ãŸã³ã« **å‰¯ä½œç”¨ãŒå†å®Ÿè¡Œ**ã•ã‚Œã‚‹
* æ¯å›ä¿å­˜ãŒèµ°ã‚‹ã®ã§ã€**ç„¡é§„ãŒå¤šã„**
* æœ¬æ¥ã¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½•ã‹ã—ãŸã¨ãã€ã«ä¿å­˜ã—ãŸã„ã®ã«ã€**å¤‰æ›´ã®ãŸã³ã«ä¿å­˜ã•ã‚Œã¦ã—ã¾ã†**

**âœ… è§£æ±ºç­–**
> ã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­ã§å‡¦ç†ã™ã‚‹

```tsx
const handleClick = () => {
  const newCount = count + 1
  setCount(newCount)
  localStorage.setItem("count", String(newCount))
}
```

ã“ã‚Œãªã‚‰ï¼š

* çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨å‰¯ä½œç”¨ã®ç™ºç”ŸãŒä¸€è‡´
* å‰¯ä½œç”¨ãŒ **è‡ªç„¶ãªå ´æ‰€ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå†…ï¼‰** ã«ç½®ã‹ã‚Œã¦ã„ã¦ã€æ„å›³ãŒæ˜ç¢º

# 3ï¸âƒ£å¤–éƒ¨ã¨ã®åŒæœŸã¯ useEffect ã«æ›¸ã

**âŒ ãƒ€ãƒ¡ãªä¾‹**
> APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ä¸­ã«å®Ÿè¡Œã—ã‚ˆã†ã¨ã™ã‚‹

```tsx
function Message() {
  const data = fetch("/api/message").then(res => res.json())

  return <p>{/* ã“ã“ã«ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ãŸã„ */}</p>
}
```

**ğŸ§¨ ãªã«ãŒå•é¡Œï¼Ÿ**

* **`fetch()` ãŒæ¯å›ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ä¸­ã«å®Ÿè¡Œã•ã‚Œã‚‹**
* ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ä¸­ã«å‰¯ä½œç”¨ãŒèµ°ã£ã¦ã—ã¾ã£ã¦ã„ã‚‹
* å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚‚äºˆæ¸¬ã—ã¥ã‚‰ãã€çŠ¶æ…‹ã¨åˆã‚ãªããªã‚‹

**âœ… è§£æ±ºç­–**
> useEffectã§å‡¦ç†ã™ã‚‹

```tsx
function Message() {
  const [text, setText] = useState("")

  useEffect(() => {
    fetch("/api/message")
      .then(res => res.json())
      .then(data => setText(data.text))
  }, [])

  return <p>{text}</p>
}
```

ã“ã‚Œãªã‚‰ï¼š

* å‰¯ä½œç”¨ï¼ˆAPIé€šä¿¡ï¼‰ã¯**æç”»å¾Œã«1å›ã ã‘å®Ÿè¡Œ**
* `message` ã‚’çŠ¶æ…‹ã«ã‚»ãƒƒãƒˆã™ã‚Œã°ã€ReactãŒå†æç”»ã—ã¦ãã‚Œã‚‹

# ãŠã‚ã‚Šã«

å‰¯ä½œç”¨ã®æ‰±ã„æ–¹ã¯ã€Reactã®ä¸­ã§ã‚‚ã¤ã¾ãšãã‚„ã™ã„ãƒã‚¤ãƒ³ãƒˆã§ã™ãŒã€
**ã“ã®3ã¤ã®ãƒ«ãƒ¼ãƒ«**ã‚’è¦šãˆã¦ãŠãã ã‘ã§ã€ã‹ãªã‚Šå®‰å…¨ã§ã‚ã‹ã‚Šã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

> å‰¯ä½œç”¨ã‚’ã©ã“ã«æ›¸ãã‹è¿·ã£ãŸã‚‰ã€
> ã€Œæç”»ä¸­ï¼Ÿ useEffectï¼Ÿ ã‚¤ãƒ™ãƒ³ãƒˆä¸­ï¼Ÿã€
> ã¨è‡ªå•ã—ã¦ã¿ã¦ãã ã•ã„ï¼
