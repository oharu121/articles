# はじめに

ウイルス対策ソフト（防毒ソフト）は、私たちのPCをマルウェアやウイルスから守ってくれる心強い存在です。  しかし、その内部ではどのように「ウイルスを検出」しているのでしょうか？

この記事では、ウイルス対策ソフトが採用している代表的な4つの検出手法について紹介します。

# 1. チェックサム法（Checksum Method）

ファイルの **サイズ** や **ハッシュ値（チェックサム）** を記録し、それが変更されていないかを定期的にチェックします。

>- ハッシュ値とは：ファイルの中身を数値化した“指紋”のようなもの
>- 例：MD5, SHA-256などのアルゴリズム

**利点**

>- 比較的軽量で高速
>- ファイルの改ざんをすぐに検出できる

**欠点**

>- ウイルスそのものを特定できない（変化の「兆候」を検出するだけ）
>- ハッシュ値だけを見ているので、意図しない正常な変更も誤検知される可能性あり

# 2. コンペア法（Comparison Method）

ファイルの「感染前」と「感染後」の状態を比較して違いを検出する手法です。  
つまり、**正常な状態のコピー**を事前に保存しておく必要があります。

**利点**

>- 明確に「どこが書き換えられたか」がわかる
>- 特定の環境に対して高い精度を発揮

**欠点**

>- 感染前のデータ（クリーンなバックアップ）がないと比較できない
>- ストレージ容量や運用コストが増加

# 3. パターンマッチング法（Pattern Matching）

既知のウイルスの **構造やシグネチャ（特徴的なバイナリ列）** と照合し、一致すれば検出します。

>- 多くの市販アンチウイルス製品の基本
>- 定義ファイル（パターンファイル）を頻繁に更新する必要あり

**利点**

>- 精度が高く、既知のウイルスに非常に強い
>- 誤検出が少ない

**欠点**

>- 未知のウイルスや変異型ウイルスには対応できない
>- 定義ファイルが古いと見逃す可能性あり

# 4. ビヘイビア法（Behavior Monitoring / Sandbox）

ソフトウェアの**動作を監視**し、不審な行動（たとえば勝手にファイルを書き換える、ネットに大量通信するなど）があればウイルスと判断する手法。

>- サンドボックス（仮想環境）に実行させて様子を見る方式も含まれる

**利点**

>- 未知のウイルスにも対応可能（ゼロデイ攻撃にも有効）
>- 実行時の振る舞いで判断するため、理論上は検出範囲が広い

**欠点**

>- 誤検出のリスクがある（正当なソフトの誤判定）
>- システムへの負荷が大きく、動作が重くなることも

# 5. **ヒューリスティック法（Heuristic Analysis）**

既知・未知にかかわらず、**怪しいコードの構造や命令パターン**を見つけてウイルスの可能性を判断する方法です。  

>* コードの **静的解析**（実行せずに中身を調べる）を行うのが特徴です。

**利点**

>- 未知のウイルスやマルウェアにもある程度対応可能
>- 動作前に検出できる

**欠点**

>- 誤検出（False Positive）のリスクがある
>- 実行動作までは確認できない（＝ビヘイビア法とは違う）

# 6. 機械学習ベースの検出（AI/ML Detection）

過去のウイルスデータや挙動ログを学習させた **AIモデル（機械学習モデル）** によって、新種のマルウェアの特徴を予測して検出します。

**利点**

>- 高度な未知の攻撃にも対応可能
>- パターンマッチングを超えた柔軟な判断ができる

**欠点**

>- 学習データの質・量に依存
>- 誤検出のリスクあり
>- 演算コストが高い（クラウド連携が多い）

# 7. **クラウドベースの検出（Cloud-Based Analysis）**

怪しいファイルをクラウド上のサーバにアップロードし、**他のユーザーからの検出履歴やAIモデル**と照合して判断します。

**利点**

>- ローカル環境を汚さず、安全に分析可能
>- 大規模なシグネチャ共有やAI分析が可能

**欠点**

>- ネットワーク環境に依存する
>- プライバシーや機密情報の取り扱いに注意が必要

# 8. **コードエミュレーション（Code Emulation）**

ファイルを本当に実行するのではなく、 **仮想的なCPU・メモリ環境で少しだけ動かして挙動を見る** という方法です。

**利点**

>- 短時間で「実行時の動き」を模擬できる
>- サンドボックスより軽量なケースもある

**欠点**

>- 高度なマルウェアはエミュレーションを回避してくる
>- 分析が中途半端になることもある

# おわりに

今やウイルスは日々進化し、新しい亜種が生まれ続けています。  
私たちができることは、**ウイルス対策ソフトを最新の状態に保ち**、そして**基本的なセキュリティ意識を忘れないこと**です。

「検出手法を知ること」は、その第一歩になるかもしれません。
